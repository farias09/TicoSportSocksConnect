@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<!doctype html>
<html lang="en">

<head>

    <meta charset="utf-8" />
    <title>Reportes | Tico Sport Socks</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta content="Reportes de Tico Sport Socks" name="description" />
    <meta content="Tico Sport Socks" name="author" />
    <!-- App favicon -->
    <link rel="shortcut icon" href="~/images/favicon.ico">


    <!-- dark layout js -->
    <script src="~/js/pages/layout.js"></script>
    <link rel="stylesheet" href="~/css/bootstrap.css" />
    <link rel="stylesheet" href="~/css/app.css" />
    <link rel="stylesheet" href="~/css/icons.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>



    <!-- dark layout js -->
    <link rel="stylesheet" href="~/js/pages/layout.js" />
    <link rel="stylesheet" href="~/css/icons.min.css" type="text/css" />

</head>

<body>

    <!-- Begin page -->
    <div class="container mt-4">
        <!-- Encabezado principal -->
        <div class="text-center mb-4">
            <h1>Reportes y Estadísticas</h1>
            <p class="text-muted">Analiza el desempeño de tus ventas e inventarios con estadísticas avanzadas</p>
        </div>

        <!-- Resumen general -->
        <div class="row mb-4">
            <div class="col-md-3">
                <div class="card text-center">
                    <div class="card-body">
                        <h5>Total de Ventas</h5>
                        <h2 class="text-primary">₡1,200,000</h2>
                        <p class="text-muted">Este mes</p>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card text-center">
                    <div class="card-body">
                        <h5>Promedio Mensual</h5>
                        <h2 class="text-success">₡300,000</h2>
                        <p class="text-muted">Promedio en los últimos 4 meses</p>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card text-center">
                    <div class="card-body">
                        <h5>Crecimiento</h5>
                        <h2 class="text-info">+15%</h2>
                        <p class="text-muted">Comparado con el mes pasado</p>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card text-center">
                    <div class="card-body">
                        <h5>Inventario Actual</h5>
                        <h2 class="text-warning">420 productos</h2>
                        <p class="text-muted">Stock disponible</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Gráficos y tablas -->
        <div class="row mb-4">
            <!-- Gráficos de ventas -->
            <div class="col-xl-6">
                <div class="card">
                    <div class="card-body">
                        <div>
                        <h5 class="card-title">Equipo de Ventas</h5>
                        <p class="text-muted">Desempeño de empleados por solicitud procesada</p>
                    

                    
                        <div class="bg-light">
                            <div id="area_chart-months" data-colors='["--bs-danger"]' class="apex-charts" dir="ltr"></div>
                        </div>

                        
                        <div class="github-style d-flex align-items-center my-2">
                            <div class="flex-shrink-0 me-2">
                                <img class="avatar-2xs rounded" src="~/images/users/avatar-1.png" data-hovercard-user-id="634573" alt="" />
                            </div>
                            <div class="flex-grow-1">
                                <a class="font-size-14 text-dark fw-medium">Empleado 1</a>
                                <div class="cmeta text-muted font-size-11">
                                        <span>248</span> Ventas Procesadas
                                </div>
                            </div>
                        </div>

                            <div class="github-style d-flex align-items-center my-2">
                                <div class="flex-shrink-0 me-2">
                                    <img class="avatar-2xs rounded" src="~/images/users/avatar-2.png" data-hovercard-user-id="634573" alt="" />
                                </div>
                                <div class="flex-grow-1">
                                    <a class="font-size-14 text-dark fw-medium">Empleado 2</a>
                                    <div class="cmeta text-muted font-size-11">
                                        <span>92</span> Ventas Procesadas
                                    </div>
                                </div>
                            </div>

                        <div class="bg-light">
                            <div id="area_chart-years" data-colors='["--bs-primary"]' class="apex-charts" dir="ltr"></div>
                        </div>

                    </div>
                </div>
                </div><!-- end card -->
            </div>

            <!-- Gráfico de rotación de inventarios -->
            <div class="col-xl-6">
                <div class="card">
                    <div class="card-body">
                        <h4 class="card-title mb-0">Productos mas Vendidos</h4>
                        <p class="text-muted">Estadisticas de desempeño basado en popularidad por producto</p>

                        <div id="area_chart_irregular" data-colors='["--bs-primary", "--bs-warning", "--bs-info"]' class="apex-charts" dir="ltr"></div>
                    </div><!-- end card-body -->
                </div><!-- end card -->
            </div>
        </div>

        <div class="row">
            <div class="col-xl-12">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">Tendencia de Ventas</h5>
                        <p class="text-muted">Evolución de ventas en el tiempo</p>
                    
                        <div>
                            <div id="brushchart_line2" data-colors='["--bs-success"]' class="apex-charts" dir="ltr"></div>
                            <div id="brushchart_line" data-colors='["--bs-info"]' class="apex-charts" dir="ltr"></div>
                        </div>
                    </div><!-- end card -->
                </div>
            </div>
        </div>

        <!-- Estadísticas por producto y exportar reportes -->
        <div class="row">
            <!-- Productos destacados -->
            <div class="col-md-8">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">Desempeño por Producto</h5>
                        <p class="text-muted">Productos más vendidos y su desempeño (Semestral)</p>
                        <table class="table table-hover">
                            <thead class="table-light">
                                <tr>
                                    <th>Producto</th>
                                    <th>Unidades Vendidas</th>
                                    <th>Ingresos</th>
                                    <th>Rotación</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Producto A</td>
                                    <td>150</td>
                                    <td>₡450,000</td>
                                    <td>Alta</td>
                                </tr>
                                <tr>
                                    <td>Producto B</td>
                                    <td>90</td>
                                    <td>₡270,000</td>
                                    <td>Media</td>
                                </tr>
                                <tr>
                                    <td>Producto C</td>
                                    <td>30</td>
                                    <td>₡90,000</td>
                                    <td>Baja</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Exportar reportes -->
            <div class="col-md-4">
                <div class="card text-center">
                    <div class="card-body">
                        <h5>Exportar Reportes</h5>
                        <p class="text-muted">Descarga los reportes en diferentes formatos</p>
                        <button class="btn btn-primary w-100 mb-2">Exportar PDF</button>
                        <button class="btn btn-secondary w-100 mb-2" onclick="exportarExcel()">Exportar Excel</button>
                        <button class="btn btn-success w-100">Exportar CSV</button>
                    </div>
                </div>
            </div>
        </div>
    </div>


        <!-- JAVASCRIPT -->
        <script src="~/libs/jquery/jquery.min.js"></script>
        <script src="~/libs/bootstrap/js/bootstrap.bundle.min.js"></script>
        <script src="~/libs/metismenu/metisMenu.min.js"></script>
        <script src="~/libs/simplebar/simplebar.min.js"></script>
        <script src="~/libs/node-waves/waves.min.js"></script>

        <!-- apexcharts -->
        <script src="~/libs/apexcharts/apexcharts.min.js"></script>
        <!-- for basic area chart -->
        <script src="~/libs/apexcharts/locales/area_chart-months.js"></script>
        <script src="~/libs/apexcharts/locales/area_chart_irregular.js"></script>
        <script src="~/libs/apexcharts/locales/area_chart_basic_design.js"></script>
    
        <script src="~/libs/moment/moment.js"></script>
        <script src="~/js/pages/apexcharts-area.init.js"></script>
        
        <script src="~/js/app.js"></script>
        <script src="~/js/pages/dashboard.init.js"></script>

    <script>
        function exportarExcel() {
            const workbook = XLSX.utils.book_new();

            const worksheet = XLSX.utils.aoa_to_sheet([
                ["Producto", "Unidades Vendidas", "Ingresos", "Rotación"],
            ]);

            XLSX.utils.book_append_sheet(workbook, worksheet, "Reporte");

            XLSX.writeFile(workbook, "reporte.xlsx");
        }
    </script>


     <script>
           document.addEventListener("DOMContentLoaded", function () {

    var brushchartLine2Colors = getChartColorsArray("brushchart_line2");
    if (brushchartLine2Colors) {
        var options = {
            series: [{
                name: 'Ganancia Total',
                data: [
                    { x: new Date(2022, 0, 1), y: 85000 },
                    { x: new Date(2022, 1, 1), y: 95000 },
                    { x: new Date(2022, 2, 1), y: 120000 },
                    { x: new Date(2022, 3, 1), y: 150000 },
                    { x: new Date(2022, 4, 1), y: 170000 },
                    { x: new Date(2022, 5, 1), y: 200000 },
                    { x: new Date(2022, 6, 1), y: 230000 },
                    { x: new Date(2022, 7, 1), y: 250000 },
                    { x: new Date(2022, 8, 1), y: 270000 },
                    { x: new Date(2022, 9, 1), y: 300000 },
                    { x: new Date(2022, 10, 1), y: 330000 },
                    { x: new Date(2022, 11, 1), y: 350000 },
                    { x: new Date(2023, 0, 1), y: 80000 },
                    { x: new Date(2023, 1, 1), y: 110000 },
                    { x: new Date(2023, 2, 1), y: 130000 },
                    { x: new Date(2023, 3, 1), y: 160000 },
                    { x: new Date(2023, 4, 1), y: 190000 },
                    { x: new Date(2023, 5, 1), y: 100000 },
                    { x: new Date(2023, 6, 1), y: 140000 },
                    { x: new Date(2023, 7, 1), y: 170000 },
                    { x: new Date(2023, 8, 1), y: 200000 },
                    { x: new Date(2023, 9, 1), y: 230000 },
                    { x: new Date(2023, 10, 1), y: 260000 },
                    { x: new Date(2023, 11, 1), y: 290000 },
                    { x: new Date(2024, 0, 1), y: 100000 },
                    { x: new Date(2024, 1, 1), y: 130000 },
                    { x: new Date(2024, 2, 1), y: 160000 },
                    { x: new Date(2024, 3, 1), y: 190000 },
                    { x: new Date(2024, 4, 1), y: 250000 },
                    { x: new Date(2024, 5, 1), y: 320000 },
                    { x: new Date(2024, 6, 1), y: 380000 },
                    { x: new Date(2024, 7, 1), y: 310000 },
                    { x: new Date(2024, 8, 1), y: 250000 },
                    { x: new Date(2024, 9, 1), y: 280000 },
                    { x: new Date(2024, 10, 1), y: 250000 },
                    { x: new Date(2024, 11, 1), y: 220000 }
                ]
            }],
            chart: {
                id: 'chart2',
                type: 'line',
                height: 220,
                toolbar: {
                    autoSelected: 'pan',
                    show: false
                }
            },
            colors: brushchartLine2Colors,
            stroke: {
                width: 3
            },
            dataLabels: {
                enabled: false
            },
            fill: {
                opacity: 1,
            },
            markers: {
                size: 0
            },
            xaxis: {
                type: 'datetime'
            },
            yaxis: {
                min: 50000,
                max: 450000
            },
            tooltip: {
                y: {
                    formatter: function (value) {
                        return '₡' + value.toLocaleString('es-CR') + ' colones';
                    }
                }
            },
            legend: {
                show: true,
                position: 'top',
                horizontalAlign: 'right'
            }
        };

        var chart = new ApexCharts(document.querySelector("#brushchart_line2"), options);
        chart.render();
    }

    var brushchartLineColors = getChartColorsArray("brushchart_line");
    if (brushchartLineColors) {
        var optionsLine = {
            series: [{
                name: 'Ganancia Total',
                data: [
                    { x: new Date(2022, 0, 1), y: 85000 },
                    { x: new Date(2022, 1, 1), y: 95000 },
                    { x: new Date(2022, 2, 1), y: 120000 },
                    { x: new Date(2022, 3, 1), y: 150000 },
                    { x: new Date(2022, 4, 1), y: 170000 },
                    { x: new Date(2022, 5, 1), y: 200000 },
                    { x: new Date(2022, 6, 1), y: 230000 },
                    { x: new Date(2022, 7, 1), y: 250000 },
                    { x: new Date(2022, 8, 1), y: 270000 },
                    { x: new Date(2022, 9, 1), y: 300000 },
                    { x: new Date(2022, 10, 1), y: 330000 },
                    { x: new Date(2022, 11, 1), y: 350000 },
                    { x: new Date(2023, 0, 1), y: 80000 },
                    { x: new Date(2023, 1, 1), y: 110000 },
                    { x: new Date(2023, 2, 1), y: 130000 },
                    { x: new Date(2023, 3, 1), y: 160000 },
                    { x: new Date(2023, 4, 1), y: 190000 },
                    { x: new Date(2023, 5, 1), y: 100000 },
                    { x: new Date(2023, 6, 1), y: 140000 },
                    { x: new Date(2023, 7, 1), y: 170000 },
                    { x: new Date(2023, 8, 1), y: 200000 },
                    { x: new Date(2023, 9, 1), y: 230000 },
                    { x: new Date(2023, 10, 1), y: 260000 },
                    { x: new Date(2023, 11, 1), y: 290000 },
                    { x: new Date(2024, 0, 1), y: 100000 },
                    { x: new Date(2024, 1, 1), y: 130000 },
                    { x: new Date(2024, 2, 1), y: 160000 },
                    { x: new Date(2024, 3, 1), y: 190000 },
                    { x: new Date(2024, 4, 1), y: 250000 },
                    { x: new Date(2024, 5, 1), y: 320000 },
                    { x: new Date(2024, 6, 1), y: 380000 },
                    { x: new Date(2024, 7, 1), y: 310000 },
                    { x: new Date(2024, 8, 1), y: 250000 },
                    { x: new Date(2024, 9, 1), y: 280000 },
                    { x: new Date(2024, 10, 1), y: 250000 },
                    { x: new Date(2024, 11, 1), y: 220000 }
                ]
            }],
            chart: {
                id: 'chart1',
                height: 130,
                type: 'area',
                brush: {
                    target: 'chart2',
                    enabled: true
                },
                selection: {
                    enabled: true,
                    xaxis: {
                        min: new Date('19 Jun 2023').getTime(),
                        max: new Date('14 Aug 2023').getTime()
                    }
                },
            },
            colors: brushchartLineColors,
            fill: {
                type: 'gradient',
                gradient: {
                    opacityFrom: 0.91,
                    opacityTo: 0.1,
                }
            },
            xaxis: {
                type: 'datetime',
                tooltip: {
                    enabled: false
                }
            },
            yaxis: {
                min: 50000,
                max: 450000,
                tickAmount: 2,
                labels: {
                    formatter: function (value) {
                        return '₡' + value.toLocaleString('es-CR');
                    }
                }
            },
            tooltip: {
                y: {
                    formatter: function (value) {
                        return '₡' + value.toLocaleString('es-CR') + ' colones';
                    }
                }
            }
        };

        var chartLine = new ApexCharts(document.querySelector("#brushchart_line"), optionsLine);
        chartLine.render();
    }
});
        </script>


   
</body>

</html>